#!/bin/zsh

# í˜„ì¬ ë¸Œëœì¹˜ ê°€ì ¸ì˜¤ê¸°
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# main ë˜ëŠ” release/* íŒ¨í„´ê³¼ ë§¤ì¹­ë˜ë©´ ë¹Œë“œ ì‹¤í–‰
if [[ "$CURRENT_BRANCH" == "main" || "$CURRENT_BRANCH" == release/* ]]; then
  echo "ğŸ”¨ Running build before pushing..."
  
  # Next.js ë¹Œë“œ ì‹¤í–‰
  if ! pnpm run build; then
    echo "âŒ Build failed! Push aborted."
    exit 1
  fi
fi

# í‘¸ì‰¬ ì‹¤í–‰
echo "ğŸš€ Pushing to $CURRENT_BRANCH..."
exit 0
